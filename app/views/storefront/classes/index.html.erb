<h1>Lessen - <%= current_gym.name %></h1>

<% if @active_membership&.unlimited? %>
  <p>Je onbeperkte plan laat maximaal <%= @active_membership.daily_soft_cap %> boekingen per dag toe.</p>
<% elsif @active_membership&.credit? %>
  <p>Beschikbare credits: <strong><%= CreditLedger.remaining_for(user: current_spree_user, gym: current_gym) %></strong></p>
<% else %>
  <p>Geen actief lidmaatschap voor deze locatie.</p>
<% end %>

<% @class_types.each do |class_type| %>
  <section class="class-type">
    <h2><%= class_type.name %></h2>
    <% if class_type.description.present? %>
      <p><%= class_type.description %></p>
    <% end %>

    <% sessions = @sessions_by_class_type[class_type.id] || [] %>
    <% if sessions.any? %>
      <ul class="sessions">
        <% sessions.each do |session| %>
          <li>
            <strong><%= l(session.starts_at, format: :long) %></strong>
            <% if session.trainer_name.present? %>
              &mdash; <span>Trainer: <%= session.trainer_name %></span>
            <% end %>
            <span>(<%= session.spots_left %> plekken vrij)</span>
            <%= link_to 'Details', storefront_session_path(session, gym_slug: current_gym.slug) %>
          </li>
        <% end %>
      </ul>
    <% else %>
      <p>Geen sessies gepland in de komende weken.</p>
    <% end %>
  </section>
<% end %>
