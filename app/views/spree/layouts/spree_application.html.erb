<!DOCTYPE html>
<html lang="en" data-theme="<%= (respond_to?(:current_store) && current_store&.theme) || 'default' %>">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <title><%= content_for?(:title) ? yield(:title) : ((respond_to?(:current_store) && current_store&.name) || "Store") %></title>

    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= (render 'spree/shared/head' rescue nil) %>
    <%= yield :head %>

    <style>
      :root { --safe-bottom: env(safe-area-inset-bottom); }
      main { padding-bottom: calc(72px + var(--safe-bottom, 0px)); }
      nav.sf-bottom-nav { padding-bottom: var(--safe-bottom, 0px); }
    </style>
  </head>

  <body class="<%= (respond_to?(:body_class) ? body_class : '') %>">
    <%= (render 'spree/page_sections/header', section: (defined?(@header_section) && @header_section) ) rescue (render('spree/shared/header') rescue nil) %>

    <main id="content" role="main">
      <%= (render 'spree/shared/flash' rescue nil) %>
      <%= yield %>
    </main>

    <%= (render 'spree/shared/footer', section: (defined?(@footer_section) && @footer_section)) rescue nil %>

    <%= (render 'spree/shared/cart_pane', section: (defined?(@header_section) && @header_section)) rescue nil %>
    <% if (defined?(show_account_pane?) && show_account_pane?) rescue false %>
      <%= (render 'spree/shared/account_pane', section: (defined?(@header_section) && @header_section)) rescue nil %>
    <% end %>

    <%# Toon bottom nav alleen als ingelogd: %>
    <%= render('spree/shared/bottom_nav') if (defined?(spree_current_user) && spree_current_user.present?) %>

    <%= yield :scripts %>
  </body>
</html>